<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://thymeleaf.org/extras/spring-security"
      layout:decorate="~{layouts/main}">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>게시글 보기</title>
  <meta content="" name="description">
  <meta content="" name="keywords">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <!-- Favicons -->
  <link href="/assets/img/favicon.png" rel="icon">
  <link href="/assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="/assets/vendor/aos/aos.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="/assets/css/main.css" rel="stylesheet">

  <style>
    /* 공통 스타일 */
    .post-header,
    .comment-section,
    .comment-card,
    .comment-form {
      border-radius: 5px;
      padding-left: 20px;
      padding-right: 20px;
      padding-top: 20px;
      padding-bottom: 0; /* 하단 여백 없음 */
      margin-bottom: 20px; /* 하단 여백 */
    }

    /* 삭제 상단 버튼 스타일 */
    .comment-header a.text-button {
      font-size: 12px; /* 삭제 버튼 글씨 크기 작게 조정 */
      color: red; /* 삭제 버튼 색상 설정 */
      margin-left: 10px; /* 삭제 버튼을 왼쪽으로 이동 */
      position: relative; /* 상대적 위치 설정 */
      top: -10px; /* 버튼을 위로 이동 */
    }

    /* .post-header의 추가 스타일 */
    .post-header {
      position: relative;
    }

    /* 게시글 제목 스타일 */
    .post-title {
      font-size: 36px; /* 제목 글씨 크기 증가 */
      font-weight: bold;
      color: #000; /* 제목 색상 검정 */
      margin-bottom: 10px; /* 제목과 하단 요소 사이의 여백 */
    }

    /* 게시글 메타 정보 스타일 */
    .post-meta {
      margin-top: 10px;
      display: flex;
      flex-direction: column; /* 열 방향으로 정렬 */
      gap: 5px; /* 행 간의 간격 */
    }

    /* 메타 정보 항목 스타일 */
    .text-wrap {
      white-space: nowrap; /* Prevent text from wrapping to the next line */
      overflow: hidden; /* Hide overflowing text */
      text-overflow: ellipsis; /* Add ellipsis for overflowing text */
    }

    .meta-item {
      font-size: 14px; /* 작성자 글씨 크기 */
      color: #555; /* 메타 정보 색상 */
      margin-bottom: 0.5rem;
    }

    .meta-info,
    .meta-details p {
      margin-bottom: 0;
    }
    /* 세부 메타 정보 스타일 */
    .meta-details {
      font-size: 12px; /* 작성일, 조회수, 추천수 글씨 크기 감소 */
      color: #888; /* 세부 메타 정보 색상 연한 회색 */
      display: flex; /* Flexbox 레이아웃 사용 */
      flex-wrap: wrap;
      gap: 8px; /* 항목 간의 간격 */
      align-items: center; /* 세로 가운데 정렬 */
      margin-bottom: 2px;
    }
    /* 게시글 액션 스타일 */
    .post-actions {
      margin-top: 10px; /* 게시글 액션 상단 여백 */
      margin-bottom: 10px; /* 게시글 액션 하단 여백 */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* 게시글 액션 버튼과 아이콘 스타일 */
    .post-actions .text-button,
    .post-actions .bi-heart,
    .post-actions .bi-heart-fill {
      color: #007bff; /* 버튼 색상 */
      font-size: 12px; /* 버튼 글씨 크기 */
      font-weight: 500; /* 버튼 글씨 두께 */
    }


    /* 상단 헤드 구분선 스타일 */
    .custom-hr {
      border-color: #343a40;
      border-width: 2px;
      margin: 5px 0; /* 상단과 하단 여백을 20px로 설정하여 간격 조정 */
    }

    /* 게시글 내용 중앙 정렬 */
    .post-content {
      height: auto;
      overflow: hidden;
      margin: 0 auto; /* 좌우 여백을 자동으로 설정하여 중앙 정렬 */
      text-align: center; /* 내용 중앙 정렬 */
      padding: 0 30px; /* 좌우 여백 조정 */
    }

    /* 게시글 내용의 글자 크기 */
    .post-content p {
      font-size: 18px; /* 내용 글씨 크기 증가 */
      line-height: 1.6; /* 줄 높이 증가 */
      text-align: left; /* 왼쪽 정렬 추가 */
      margin-bottom: 50px; /* 하단 마진 추가 */
    }


    /* 게시글 이미지 중앙 정렬 */
    .post-image {
      max-width: 100%;
      height: auto;
      margin: 10px auto 100px; /* 상단 여백, 좌우 여백 자동 설정 */
    }

    /* 댓글 입력 폼 스타일 */
    .comment-form {
      margin-bottom: 20px;
      background-color: transparent; /* 배경색을 투명하게 설정 */
      padding: 0; /* 기본 padding 제거 */
    }

    .comment-form textarea {
      font-size: 14px; /* 기본 입력 폰트 크기 */
      height: 100px; /* 높이 조정 (세로 크기 증가) */
      resize: vertical; /* 세로로만 크기 조정 가능 */
    }

    /* 댓글 입력 필드와 버튼 스타일 */
    .comment-form input,
    .comment-form textarea {
      width: 100%; /* 너비를 100%로 설정 */
      box-sizing: border-box; /* 테두리와 padding이 요소의 전체 크기에 포함되도록 설정 */
      font-size: 14px; /* 기본 폰트 크기 설정 */
      padding: 10px; /* 내부 여백 설정 */
      border: 1px solid rgba(0, 0, 0, 0.1); /* 테두리 색상 설정 */
      border-radius: 5px; /* 모서리 둥글게 설정 */
      margin-bottom: 10px; /* 하단 여백 설정 */
    }

    .comment-form textarea {
      resize: none; /* 리사이즈 기능 비활성화 */
      overflow: hidden; /* 오버플로우 숨김 */
    }

    /* 댓글 등록 버튼 스타일 */
    .comment-form button {
      padding: 6px 12px; /* 버튼 여백 설정 */
      font-size: 12px; /* 버튼 폰트 크기 설정 */
      border-radius: 5px; /* 버튼 모서리 둥글게 설정 */
      margin-top: 10px; /* 상단 여백 설정 */
      position: relative; /* 위치 조정 */
      background-color: transparent; /* 기본 배경색 투명 */
      color: gray; /* 기본 텍스트 색상 */
      border: 2px solid gray; /* 버튼 테두리 설정 */
      font-weight: bold; /* 폰트 굵기 설정 */
      transition: background-color 0.3s, color 0.3s; /* 부드러운 색상 전환 */
    }

    .comment-form button:hover {
      background-color: green; /* 마우스 오버 시 배경색 변경 */
      color: white; /* 마우스 오버 시 텍스트 색상 변경 */
      border: 2px solid green; /* 마우스 오버 시 테두리 색상 변경 */
    }


    /* 댓글 카드 스타일 */
    .comment-card {
      margin-bottom: 5px;
      padding: 10px;
      position: relative;
      background-color: #fff; /* 배경색을 흰색으로 설정 */
      border: 1px solid rgba(0, 0, 0, 0.1); /* 테두리 추가 */
      border-radius: 5px; /* 모서리 둥글게 설정 */
    }

    /* 댓글 헤더 스타일 */
    .comment-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 5px;
    }

    .comment-header .nick-name {
      font-weight: bold;
      font-size: 14px; /* 댓글 작성자 이름 폰트 크기 설정 */
    }

    .comment-header .delete-button {
      color: red;
      text-decoration: none;
      font-size: 12px; /* 삭제 버튼 폰트 크기 설정 */
    }

    .comment-header .delete-button:hover {
      text-decoration: underline;
    }

    /* 댓글 본문 */
    .comment-body {
      line-height: 0.5; /* 행간을 좁게 조정 */
    }

    .btn-group {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    /* 기본 버튼 스타일 */
    .btn {
      padding: 6px 12px;
      font-size: 12px;
      border-radius: 5px;
    }

    /* 댓글 스타일 */
    .comment {
      padding: 0 20px; /* 상하좌우 여백 맞춤 */
      font-size: 15px; /* 댓글 글씨 크기 조정 */
      line-height: 0.7; /* 행간 조정 (좁게 설정) */
      text-align: left; /* 좌측 정렬 */
      position: relative; /* 상대 위치 지정 */
    }

    /* 댓글 작성자 스타일 */
    .comment-header {
      display: flex;
      justify-content: space-between; /* 작성자와 삭제 버튼 간의 여백 조정 */
      align-items: flex-start; /* 작성자와 삭제 버튼을 상단 정렬 */
      padding-right: 10px; /* 댓글 작성자 및 내용에 대한 우측 여백 추가 */
    }

    /* 작성자 텍스트 스타일 */
    .comment-header a {
      color: black; /* 작성자 색상 블랙으로 설정 */
      font-weight: bold; /* 작성자 텍스트 두껍게 설정 */
      margin-right: auto; /* 작성자를 왼쪽으로 정렬 */
      margin-left: 10px; /* 작성자 왼쪽 여백 추가 */
    }

    /* 댓글 내용 스타일 */
    .comment p {
      margin-top: 2px; /* 댓글 내용과 작성자 간의 여백 좁히기 */
      margin-right: 10px; /* 댓글 내용 오른쪽 여백 추가 */
      line-height: 1.1; /* 댓글 내용 행간 조정 (좁게 설정) */
      margin-left: 10px; /* 댓글 내용 왼쪽 여백 추가 */
      padding-right: 30px; /* 오른쪽에 패딩을 추가하여 글자 넘침 방지 */
      font-size: 15px !important; /* 댓글 글씨 크기 조정 (우선순위 높이기) */
    }

    /* 작성일 텍스트 스타일 */
    .comment-date {
      display: block;
      line-height: 1.1; /* 작성일 행간 조정 (좁게 설정) */
      font-size: 12px; /* 작성일 글씨 크기 조정 */
      margin-top: -10px; /* 작성일을 위로 이동 */
      color: #6c757d; /* 작성일 색상 조정 */
      margin-left: 10px; /* 댓글 내용 왼쪽 여백 추가 */
      margin-right: 10px; /* 댓글 내용 오른쪽 여백 추가 */
    }

    /* 댓글 날짜와 삭제 버튼 */
    .comment-footer {
      display: flex;
      justify-content: space-between; /* 양 끝에 요소 배치 */
      align-items: center; /* 수직 가운데 정렬 */
      line-height: 0.5; /* 행간을 더 좁게 조정 */
    }
    /* 댓글 삭제 기능 */
    .text-button {
      color: red; /* 기존 스타일을 유지하기 위해 색상 추가 */
      text-align: right; /* 오른쪽 정렬 */
      font-size: 12px; /* 삭제 크기 조정 */
      padding-bottom: 5px; /* 아래쪽 패딩 추가 */
      padding-right: 15px; /* 오른쪽에 패딩 추가 */
    }

    /* 댓글 구분선 스타일 */
    .comment-divider {
      border-top: 1px solid #343a40; /* 구분선 색상 및 두께 */
      width: calc(100%); /* 전체 너비에서 오른쪽 15px 줄이기 */
      margin: 5px 0; /* 상단 및 하단 여백 5px, 좌우 여백 0 */

    }

    /* 큰 화면 (1200px 이상) */
    @media (min-width: 1200px) {
      .post-title {
        font-size: 24px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .post-meta {
        font-size: 14px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .btn {
        padding: 8px 16px;
        font-size: 12px;
      }
      .comment-form input,
      .comment-form textarea {
        font-size: 14px;
      }
      .post-image {
        max-width: 100%;
        height: auto;
      }
    }

    /* 작은 화면 (1200px 이하) */
    @media (max-width: 1199px) {
      .post-title {
        font-size: 20px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .post-meta {
        font-size: 12px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .btn {
        padding: 5px 10px;
        font-size: 11px;
      }
      .comment-form input,
      .comment-form textarea {
        font-size: 12px;
      }
      .post-image {
        max-width: 100%;
        height: auto;
      }
    }

    /* 더 작은 화면 (768px 이하) */
    @media (max-width: 768px) {
      .post-title {
        font-size: 18px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .post-meta {
        font-size: 15px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .post-content p {
        font-size: 12px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .post-actions .btn {
        padding: 4px 8px;
        font-size: 10px;
      }
      .post-actions .text-button {
        font-size: 14px;
      }
      .comment-form input,
      .comment-form textarea {
        font-size: 10px;
      }
      .comment-form textarea {
        font-size: 12px;
      }
      .comment-header .nick-name,
      .comment p {
        font-size: 12px;
      }
      .comment-card {
        padding: 5px;
      }
      .post-header,
      .comment-card,
      .comment-form {
        padding: 8px;
      }
      .post-image {
        max-width: 100%;
        height: auto;
      }
    }

    /* 아주 작은 화면 (500px 이하) */
    @media (max-width: 500px) {
      .post-title {
        font-size: 14px;
      }
      .post-meta {
        font-size: 10px;
      }
      .post-content p {
        font-size: 10px;
      }
      .post-actions .btn {
        padding: 2px 4px; /* 버튼의 여백을 줄임 */
        font-size: 8px; /* 텍스트 크기를 더 작게 설정 */
        border-radius: 3px; /* 버튼의 모서리 둥글게 설정 */
        white-space: nowrap; /* 텍스트가 줄 바꿈 없이 한 줄로 유지되게 설정 */
        overflow: hidden; /* 텍스트가 버튼 영역을 넘지 않도록 설정 */
      }
      .post-actions .text-button {
        font-size: 10px; /* 텍스트 버튼의 폰트 크기 조정 */
      }
      .comment-form input,
      .comment-form textarea {
        font-size: 8px;
      }
      .comment-form textarea {
        font-size: 10px;
      }
      .comment-header .nick-name,
      .comment p {
        font-size: 10px;
      }
      .comment-card {
        padding: 3px;
      }
      .post-header,
      .comment-card,
      .comment-form {
        padding: 5px;
      }
      .post-image {
        max-width: 100%; /* 최대 너비를 100%로 설정하여 화면 크기에 맞게 조정 */
        height: auto; /* 비율을 유지하면서 높이를 자동 조정 */
      }
      @media (min-width: 576px) {
        .meta-details {
          flex-wrap: wrap;
          align-items: center;
        }
      }

    }



  </style>
</head>

<body class="services-page">

<div layout:fragment="content">
  <main class="main">
    <!-- Page Title -->
    <div class="page-title" style="background-color: #003300;">
      <div class="container text-center">
        <h1 style="color: white;">게시판 정보</h1>
        <nav class="breadcrumbs">
          <div>
            <span style="color: white;">귀농귀촌에 관한 정보나 건의사항이나 질문이 있으시면 언제든지 문의해주세요.</span>
          </div>
        </nav>
      </div>
    </div>
    <!-- End Page Title -->

    <!--상단 수정/삭제/목록/신고하기 버튼들-->
    <div class="container col-md-8 col-lg-6">
      <div class="d-flex justify-content-between align-items-center mt-3 mb-2">
        <!-- 수정과 삭제 버튼 -->
        <div class="d-flex gap-2 mt-3">
          <div th:if="${#authentication.name == boardDTO.author}">
            <a th:href="@{/board/edit(id=${boardDTO.id})}" class="btn btn-outline-info rounded-pill">수정</a>
            <a th:href="@{/board/delete(id=${boardDTO.id})}" class="btn btn-outline-danger rounded-pill"
               th:onclick="return confirm('정말 삭제하시겠습니까?')">삭제</a>
          </div>
          <div th:unless="${#authentication.name == boardDTO.author}">
          <span sec:authorize="hasAnyRole('ROLE_admin','ROLE_master')">
            <a th:href="@{/board/edit(id=${boardDTO.id})}" class="btn btn-outline-info rounded-pill">수정</a>
            <a th:href="@{/board/delete(id=${boardDTO.id})}" class="btn btn-outline-danger rounded-pill"
               th:onclick="return confirm('정말 삭제하시겠습니까?')">삭제</a>
          </span>
          </div>
        </div>
        <!-- 목록과 신고하기 버튼 -->
        <div class="d-flex gap-2 mt-3">
          <a th:href="@{/board/list}" class="btn btn-secondary">목록</a>
          <a href="#" class="btn btn-danger details-link"
             th:onclick="'openReportWindow(' + ${boardDTO.id} + ')'">신고하기</a>
        </div>
      </div>


      <!-- 게시글 카드 -->
      <div class="card">
        <div class="card-body">
          <!-- 게시글 상단 -->
          <div class="post-header d-flex flex-column">
            <div class="d-flex flex-column align-items-start">
              <h1 class="post-title" th:text="${boardDTO.title}">제목</h1>
            </div>
            <div class="post-meta mt-2 d-flex flex-column flex-sm-row justify-content-between align-items-start">
              <div class="meta-item">
                <span th:text="${boardDTO.author}">작성자</span>
              </div>
              <div class="meta-details d-flex flex-column flex-sm-row justify-content-between align-items-start w-100">
                <p class="meta-info mb-0 text-wrap">
                  <span th:text="${#temporals.format(boardDTO.modDate, 'yyyy-MM-dd HH:mm')}">2024-01-01 12:00</span> |
                  <span th:text="'조회수: ' + ${boardDTO.viewCount}">조회수</span> |
                  <span th:text="'추천수: ' + ${boardDTO.likeCount}">추천수</span>
                </p>
                <!-- 게시글 액션 -->
                <p class="mb-0 text-wrap">
                  <a th:href="@{/board/like(id=${boardDTO.id})}" class="text-button">
                    <i class="bi" th:class="${hasLiked ? 'bi-heart-fill' : 'bi-heart'}"></i>
                    <span th:text="'좋아요 ' + ${boardDTO.likeCount}" class="ml-2"><strong>♡좋아요1</strong></span>
                  </a>
                </p>
              </div>
            </div>
            <!-- 게시글 상단과 내용 사이에 구분선 추가 -->
            <hr class="my-2 custom-hr">
          </div>

          <!-- 게시글 내용 -->
          <div class="post-content mt-lg-1 text-center">
            <p th:text="${boardDTO.content}">내용</p>
            <div>
                <img th:src="|https://${bucket}.s3.${region}.amazonaws.com/${folder}/${boardDTO.boardImg}|"
                     class="post-image"
                     th:if="${boardDTO.boardImg != null and !#strings.isEmpty(boardDTO.boardImg)}">
            </div>
          </div>

          <!-- 댓글 목록 -->
          <div class="comment-list">
            <div th:each="comment : ${commentDTOS}" class="comment">
              <div class="comment-header d-flex justify-content-between align-items-center mb-1">
                <a th:href="@{/user/info(username=${comment.nickName})}" th:text="${comment.nickName}"></a>
                <span th:if="${#authentication != null and #authentication.name == comment.nickName}"></span>
              </div>
              <p class="comment-body" th:text="${comment.body}">댓글 내용</p>
              <div class="comment-footer d-flex justify-content-between align-items-center">
                <span class="comment-date" th:text="${#temporals.format(comment.modDate, 'yyyy-MM-dd HH:mm')}">2024-01-01 12:00</span>

                <span th:if="${#authentication != null and (#authentication.name == comment.nickName or #authorization.expression('hasAnyRole(''ROLE_admin'', ''ROLE_master'')'))}">
                    <a th:href="@{/comment/remove(no=${boardDTO.id},id=${comment.id})}" class="text-button">삭제</a>
                </span>
              </div>
              <!-- 댓글 아래에 구분선 추가 -->
              <hr class="comment-divider">
            </div>
          </div>

          <!-- 댓글 입력폼 -->
          <div class="card-body">
            <form th:action="@{/comment/insert}" method="post" class="comment-form">
              <input type="hidden" name="no" th:value="${boardDTO.id}">
              <input type="hidden" name="username" th:value="${userDTO.username}">

              <!-- 댓글 입력란과 닉네임 (좌상단에 위치) -->
              <div class="position-relative">
                <strong class="d-block" th:text="${userDTO.username}"
                        style="position: absolute; top: 10px; left: 20px; z-index: 1;">닉네임</strong>
                <textarea class="form-control" id="body" name="body" maxlength="150"
                          placeholder="댓글을 입력하세요" required oninput="checkLength(this)"
                          style="padding: 50px 90px 0px 20px; resize: none; overflow: hidden"
                          rows="1"></textarea>
                <button type="submit" class="submit text-button position-absolute"
                        style="bottom: 0px; right: 10px; height: auto; margin-right: 8px;
               background-color: transparent; color: gray; border: none; font-weight: bold;
               transition: color 0.3s, background-color 0.3s;"> 등록
                </button>
              </div>
            </form>
          </div>


        </div>
      </div>
    </div>
  </main>
</div>
</body>

</html>